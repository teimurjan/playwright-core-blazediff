{
  "version": 3,
  "sources": ["../../src/server/download.ts"],
  "sourcesContent": ["/**\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport path from 'path';\n\nimport { Page } from './page';\nimport { assert } from '../utils';\nimport { Artifact } from './artifact';\n\nexport class Download {\n  readonly artifact: Artifact;\n  readonly url: string;\n  private _page: Page;\n  private _suggestedFilename: string | undefined;\n\n  constructor(page: Page, downloadsPath: string, uuid: string, url: string, suggestedFilename?: string) {\n    const unaccessibleErrorMessage = page.browserContext._options.acceptDownloads === 'deny' ? 'Pass { acceptDownloads: true } when you are creating your browser context.' : undefined;\n    this.artifact = new Artifact(page, path.join(downloadsPath, uuid), unaccessibleErrorMessage, () => {\n      return this._page.browserContext.cancelDownload(uuid);\n    });\n    this._page = page;\n    this.url = url;\n    this._suggestedFilename = suggestedFilename;\n    page.browserContext._downloads.add(this);\n    if (suggestedFilename !== undefined)\n      this._fireDownloadEvent();\n  }\n\n  page(): Page {\n    return this._page;\n  }\n\n  _filenameSuggested(suggestedFilename: string) {\n    assert(this._suggestedFilename === undefined);\n    this._suggestedFilename = suggestedFilename;\n    this._fireDownloadEvent();\n  }\n\n  suggestedFilename(): string {\n    return this._suggestedFilename!;\n  }\n\n  private _fireDownloadEvent() {\n    this._page.instrumentation.onDownload(this._page, this);\n    this._page.emit(Page.Events.Download, this);\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBA,kBAAiB;AAEjB,kBAAqB;AACrB,mBAAuB;AACvB,sBAAyB;AAElB,MAAM,SAAS;AAAA,EAMpB,YAAY,MAAY,eAAuB,MAAc,KAAa,mBAA4B;AACpG,UAAM,2BAA2B,KAAK,eAAe,SAAS,oBAAoB,SAAS,+EAA+E;AAC1K,SAAK,WAAW,IAAI,yBAAS,MAAM,YAAAA,QAAK,KAAK,eAAe,IAAI,GAAG,0BAA0B,MAAM;AACjG,aAAO,KAAK,MAAM,eAAe,eAAe,IAAI;AAAA,IACtD,CAAC;AACD,SAAK,QAAQ;AACb,SAAK,MAAM;AACX,SAAK,qBAAqB;AAC1B,SAAK,eAAe,WAAW,IAAI,IAAI;AACvC,QAAI,sBAAsB;AACxB,WAAK,mBAAmB;AAAA,EAC5B;AAAA,EAEA,OAAa;AACX,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,mBAAmB,mBAA2B;AAC5C,6BAAO,KAAK,uBAAuB,MAAS;AAC5C,SAAK,qBAAqB;AAC1B,SAAK,mBAAmB;AAAA,EAC1B;AAAA,EAEA,oBAA4B;AAC1B,WAAO,KAAK;AAAA,EACd;AAAA,EAEQ,qBAAqB;AAC3B,SAAK,MAAM,gBAAgB,WAAW,KAAK,OAAO,IAAI;AACtD,SAAK,MAAM,KAAK,iBAAK,OAAO,UAAU,IAAI;AAAA,EAC5C;AACF;",
  "names": ["path"]
}
